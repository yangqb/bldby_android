# 便利大本营架构文档

## 基础架构

## 页面跳转使用路由跳转(`Arouter`)[Arouter的使用](./路由的使用.md)

* 整体项目使用组件化进行模块分割

### 基础模块`baselibrary`

* `app`项目的基础逻辑业务层(可掺杂少数业务逻辑.作为核心层和业务层的连接)
  * 各个模块的路由跳转表
  * 账户逻辑系统(登录,注册,登出,注销,修改)的信息操作封装,方便各个模块的操作
* `core`项目的 核心技术层(只实现技术逻辑,不惨咋业务逻辑)

### 业务层
各个模块逻辑的具体实现,每个业务层都依赖于`baslibrary`

## 基于路由跳转实现项目的组件化

在`global.gradle`中提供参数

```gr
isBaseApplication = false  //这个不建议改
isShopApplication = true   //商品模块
```

当我们修改`isShopApplication`为true时,商品模块是一个单独的项目,改为false是商品是主项目的一个模块,base模块不建议修改,修改也没用

[组件化的实现](./组件化的实现1.md)

## `fragment`的封装处理

* 使用`fragmentation`第三方依赖库

  * 处理`fragment`的回退栈,物理退出键
  * 处理`fragment`的进出场动画,
  * 回退栈逻辑

* 项目通知使用`Rxbus`

  ![](https://bchimg.oss-cn-beijing.aliyuncs.com/picgo/20200608095657.png)

  在`base`模块的`RxCodeConstants`文件注册通知id[通知的使用](./APP内通知.md)

## 网络请求

* 基于`okhttp`的封装库`OkGO`的使用,进行二次封装
* 实现全局处理,
* 网络检测
* 数据错误,调用处理的处理,增加健壮性

## `SharedPreferences`的替代品`Hawk`

[Hawk的Github](https://github.com/orhanobut/hawk)

```java
Hawk.put(key, T);
T value = Hawk.get(key);
Hawk.delete(key);
Hawk.contains(key);
Hawk.deleteAll();
```



为什么要换

1. `SharedPreferences`不能放太多的数据,否则会造成卡顿
2. `SharedPreferences`不能储存对象类型.不支持泛型

## 组件化的使用

在`global.gradle`文件中,有所有模块的组件开关

![image-20200608165124071](https://bchimg.oss-cn-beijing.aliyuncs.com/picgo/20200608165124.png)

当模块的开关为true时这个模块是一个单独的项目,可以单独运行

## 新建Activity适配组件化

每一个组件都有两个`AndroidManifest.xml`,其中一个是用于主项目,另一个(module下的)是用于开发过程中的单独开发使用,把组件作为单独项目

![image-20200608164140588](https://bchimg.oss-cn-beijing.aliyuncs.com/picgo/20200608164140.png)

![image-20200608164213835](https://bchimg.oss-cn-beijing.aliyuncs.com/picgo/20200608164213.png)

每新建一个`activity`都要在两个清单文件中都添加,系统默认可能只添加一个,

## 组件化跳转的路由表

在`baselibrary`里有一个`constants`包,里面放的都是各个模块的路由表文件,

* `RouteConstants`文件是`主app`的路由表

其他的模块,每新建一个模块都要在这个包里面添加一个该模块的路由表

例如 :

* `RouteShopConstants`
  ![image-20200608171339850](https://bchimg.oss-cn-beijing.aliyuncs.com/picgo/20200608171339.png)

关于各个组件的`模块名MainActivity`,

* **禁止任何组件跳转,也不能跳转**
* **禁止为这个`activity`赋值路由id**

这个是当组件作为一个独立的`activity`是作为这个`app`的入口,但是在主项目中就是不存在的,