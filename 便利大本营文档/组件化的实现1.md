# 新建组件模块

## 新建`module`,导入基础依赖库和路由库

```grvooy
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation project(path: ':baselibrary')
    annotationProcessor rootProject.ext.dependencies["router-compiler"]
```

## 在`global.gradle`中配置组件开关

![image-20200608175639369](https://bchimg.oss-cn-beijing.aliyuncs.com/picgo/20200608175639.png)



## 配置`gradle`

* 打开`databinging`

* 设置`jdk`版本
* 组件化的清单文件配置,`applicationId`
* 统一版本号,编译版本,`SDK`版本

```groovy
android {
    compileSdkVersion rootProject.ext.android["compileSdkVersion"]


    defaultConfig {
        if (rootProject.ext.isShopApplication) {
            //组件模式下设置applicationId
            applicationId "com.feitianzhu.loginlibrary"
        }
        minSdkVersion rootProject.ext.android["minSdkVersion"]
        targetSdkVersion rootProject.ext.android["targetSdkVersion"]
        versionCode rootProject.ext.android["versionCode"]
        versionName rootProject.ext.android["versionName"]

        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
        javaCompileOptions {
            annotationProcessorOptions {
                arguments = [AROUTER_MODULE_NAME: project.getName()]
            }
        }
        consumerProguardFiles "consumer-rules.pro"

    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    sourceSets {
        main {
            if (rootProject.ext.isLoginApplication) {
                manifest.srcFile 'src/main/module/AndroidManifest.xml'
            } else {
                manifest.srcFile 'src/main/AndroidManifest.xml'
            }
            jniLibs.srcDirs = ['libs']
        }
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
    dataBinding {
        enabled = true
    }
}

```

### 配置组件切换项目和模块的配置

```groovy
if (rootProject.ext.isLoginApplication) {
    apply plugin: 'com.android.application'

} else {
    apply plugin: 'com.android.library'

}
```

## 配置清单文件

![image-20200608175850461](https://bchimg.oss-cn-beijing.aliyuncs.com/picgo/20200608175850.png)

在`main`文件下新建`module`文件将清单文件复制一份放入

## 配置`module`的清单文件

新建一个`activity`

查看清单文件只出现在了外部的清单文件中,

```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.feitianzhu.loginlibrary">
    <application>
    <activity
        android:name=".ui.login.LoginActivity"
        android:label="@string/title_activity_login"></activity>
            </application>
</manifest>
```

将`activity`的配置粘贴入`module`的清单文件中,并且配置为项目入口(非必须),但是每一个组件都要有一个入口

```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.feitianzhu.loginlibrary">
    <application>
    <activity
        android:name=".ui.login.LoginActivity"
               android:theme="@style/AppTheme"
        android:label="@string/title_activity_login">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
            </application>
</manifest>
```

打开组件化开关,单独运行登录模块

**在配置清单文件的时候**

```xml
 android:theme="@style/AppTheme"
```

配置主题是必须的,不配置可能会报主题的错误,我再`base`里已近配置了该主题直接调用